Данный телеграмм-бот предназначен для совершения сделок по рекламной интеграции на стриминговых платформах.


Описание работы телеграмм-бота.

Пользователи вначале выбирают роль: продавец или покупатель. 

Продавцы - это пользователи, которые работают на стриминговых платформах (YouTube, Instagram и так далее) и выставляют рекламу на своей платформе. Они регистрируют себя в телеграмм-боте заполная информационную карточку своими данными, после модерация решает, принять ли данного пользователя в роли продавца или нет.

Покупатели - это рекламодатели, которые ищут продавцов для совершения сделки по выставке своей рекламы на стриминговой платформе продавца. Они лишь регистрируют свой никнейм и начинают поиск уже зарегистрированных продавцов.

Когда покупатель находит продавца, он нажимает кнопку "написать продавцу" и ожидает ответа продавца. Продавец в свою очередь нажимает ответить и начинается диалог между двумя участниками. Они обговаривают условия сделки, а после выбирают выбор сдлеки: обычная оплата (оплата проводится между продавцом и покупателем через алгоритм в боте, перевод денежной суммы через приложение вашего банка и переводится на банк получателя) или эскроу-счёт (здесь выступает третьим участником модерация бота. Она лишь придерживает денежную сумму у себя пока продавец не выполнит условия сделки).


Внутренняя структура телеграмм-бота.

В файле test.py используется язык программирования python.

Чтобы телеграмм-бот "запоминал" информацию вписанную пользователями, используется файл с базой данных bot_db.sqlite. 

Для подключения этого файла в код проекта:

conn = sqlite3.connect(Config.DATABASE)
cursor = conn.cursor()
cursor.execute("SELECT buyer_id, seller_id FROM deals WHERE deal_id=?", (deal_id,))
buyer_id, seller_id = cursor.fetchone()
conn.close()

Как это работает:

1. Подключение к базе

conn = sqlite3.connect(Config.DATABASE)

Config.DATABASE — это путь к файлу базы данных, например database.db.

Если файл не существует — SQLite создаст новый.


2. Создание курсора

cursor = conn.cursor()

Курсор нужен для выполнения SQL-запросов.



3. Выполнение запроса

cursor.execute("SELECT buyer_id, seller_id FROM deals WHERE deal_id=?", (deal_id,))

SQL-запросы пишутся строками.

? — placeholder (подстановка параметров), чтобы избежать SQL-инъекций.

(deal_id,) — кортеж с параметром.


4. Получение данных

buyer_id, seller_id = cursor.fetchone()

fetchone() возвращает одну строку результата как tuple.

fetchall() — все строки.

fetchmany(n) — ограниченное количество строк.


5. Закрытие соединения

conn.close()

Освобождаем ресурсы после завершения работы.


6. Изменение данных (INSERT/UPDATE/DELETE)

После таких запросов обязательно:

conn.commit()

чтобы изменения записались в файл.

Заключение.
Чтобы опробовать бота вам нужно будет скачать файл test.py c кодом бота, установить файл bot_db.sqlite, запустить в вайшей среде разработки и перейти по этой ссылке t.me/nexusmarketing_bot

Пока что бот запускается только с компьютера где есть эти файлы, но в ближайшем будущем данный телеграмм-бот перейдёт на сервер и будет работать на любом устройстве где есть приложение телеграмм.